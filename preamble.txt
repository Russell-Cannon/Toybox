<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>ToyBox</title>
        <style>
            html, body, canvas{
                height:100%;
                margin:0
            }
            canvas {
                display:block;
                width:100vw;
                height:100vh
            }
        </style>
    </head>
    <body>
        <canvas id=canvas></canvas>
        <script>
            const canvas = document.getElementById('canvas');
            const gl = canvas.getContext('webgl2');
            if(!gl){ document.body.textContent = "WebGL2 required"; throw 0; }

            // Create a texture.
            var texture = gl.createTexture();
            gl.bindTexture(gl.TEXTURE_2D, texture);
            
            // Fill the texture with a 1x1 blue pixel.
            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE,
                        new Uint8Array([0, 0, 255, 255]));
            
            // Asynchronously load an image
            var image = new Image();
            image.src = "./checker-map.png";
            image.addEventListener('load', function() {
                // Now that the image has loaded make copy it to the texture.
                gl.bindTexture(gl.TEXTURE_2D, texture);
                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA,gl.UNSIGNED_BYTE, image);
                gl.generateMipmap(gl.TEXTURE_2D);
            });

            const vs = `#version 300 es
            const vec2 verts[3] = vec2[3](vec2(-1.0,-1.0), vec2(3.0,-1.0), vec2(-1.0,3.0));
            void main() {
                gl_Position = vec4(verts[gl_VertexID], 0.0, 1.0);
            }`;

            const fs = `#version 300 es
            precision highp float;
            #define PI 3.14159265359
            #define TWO_PI 6.28318530718
            uniform vec2 iResolution;
            uniform float time;
            uniform sampler2D u_texture;
            out vec4 outColor;

            //credit https://www.shadertoy.com/view/4djSRW for hash function
            float hash(vec2 st) { return fract(sin(dot(st, vec2(12.9898, 78.233))) * 43758.5453); }
            void main() { 
                